@using ToDoList.Core.Models.ToDoItem
@using ToDoList.Core.Repository

@model ToDoItems


@inject ToDoItemsService Service

<head>
    <meta name="viewport" , content="width=device=width" />
    <title>EditItem</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="Edit.cshtml/Edit.cshtml.css">
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
</head>

<body>
    <div class="p-3 font-txt">
        <div class="panel-heading text-left">
            <h2>Edit</h2>
        </div>
        
        <form asp-action="Edit" method="post">

            <input type="hidden" asp-for="Id" />

            <div class="form-group d-flex align-items-center div-class">

                <label asp-for="Description"
                       class="font-txt mb-0 mr-2">
                    Description:
                </label>

                <textarea asp-for="Description"
                          class="form-control description flex-grow-1"
                          onclick="autoExpand(this)"
                          rows="1">
                </textarea>

            </div>

            <div class="form-group div-class">
                <label asp-for="CreateDate" class="font-txt">Create Date:</label>
                <input type="date"
                       asp-for="CreateDate"
                       id="DateCreate"
                       max="@DateTime.Now.ToString("yyyy-MM-dd")" />
            </div>


            <div class="form-group d-flex align-items-center div-class">

                <label asp-for="IsCaseCompletion"
                       class="font-txt mb-0 mr-2">
                    Done:
                </label>

                <input asp-for="IsCaseCompletion"
                       type="checkbox"
                       class="form-check-input align-self-center m-2"
                       id="IsCaseComplite"
                       onchange="onHidden()" />

            </div>

            <div class="form-group div-class" id="DisplayDateComplite">
                <label asp-for="CompletDate" class="font-txt">Complete Date:</label>
                <input type="date"
                       asp-for="CompletDate"
                       id="DateCompletion"
                       max="@DateTime.Now.ToString("yyyy-MM-dd")" />
            </div>

            <div class="text-left div-class">
                <button class="btn btn-outline-success" type="submit"
                        style="font-size:16px; width: 80px; height: 40px;">
                    Save
                </button>

                <a type="button" formmethod="get" asp-action="Close" 
                   style="font-size:16px; width: 80px; height: 40px;"
                   class="btn btn-outline-danger">
                   Close
                </a>
            </div>

        </form>

    </div>

    <script>
        function autoExpand(element) {
            element.style.height = 'auto';
            element.style.height = (element.scrollHeight) + 'px';
        }
    </script>

    <script>
        function onHidden() {
            var chk = document.getElementById("IsCaseComplite");
            var divDate = document.getElementById("DisplayDateComplite");
            var inputDate = document.getElementById("DateCompletion");
            
            if (!chk.checked) {
                divDate.hidden = true;
                inputDate.value = "";
            } 
            else {
                divDate.hidden = false;
                inputDate.value = '@DateTime.Now.ToString("yyyy-MM-dd")';
            }
        }

        $(document).ready(function () {
            // Autosize
            $("textarea").each(function () {
              autoExpand(this);
            });
            
            // Checkbox state on loading
            onHidden();
        });

        window.onresize = function () {
            $("textarea").each(function () {
              autoExpand(this);
            });
        };
    </script>

</body>
